library('vegan')
library('dplyr')
SR <- read.csv('/Users/ethanbass/Box/kessler-data/solidago/succession_genotypes/data/Root_extracts_HPLC_soil_transplant.csv')
x <-  read.csv('/Users/ethanbass/Box/kessler-data/solidago/succession_genotypes/data/succession_genotypes_2020.csv')
colnames(SR)
SR[,11:29] <- apply(SR[,11:29],2,function(j) j*100/SR$Root_mass_mg)
SRM <- SR %>% group_by(Genotype) %>% mutate_if(is.numeric,.funs = c(mean,sd))
SRM <- left_join(SRM,x)
SRM <- SR %>% group_by(Genotype) %>% summarize_if(is.numeric,.funs = c(mean,sd))
SRM <- SR %>% group_by(Genotype) %>% summarize_if(is.numeric,.funs = c(mean))
#setwd('/Users/ethanbass/kessler-data/solidago/succession_genotypes')
hist(SRM$Tot_polyacet)
View(SRM[order(SRM$Genotype),c('Genotype','Tot_polyacet')])
library(stats)
m <- lapply(colnames(SRM)[11:29], function(c){
glm(substitute(factor(s) ~ i, list(i=as.name(c))), data=SRM[!(SRM$Plant_yr%in%c(4,5)),],family = 'binomial')
})
adonis2(SR[,11:25]~SR$Plant_stage)
SR$Plant_stage
adonis2(SR[,11:25] ~ Genotype*Soil_yr, data=SR)
require('chromatographR')
require('tidyverse')
require('parallel')
require('randomForest')
require('Boruta')
require('RColorBrewer')
require('vegan')
require('xlsx')
# loading root chromatograms into R #
path <- '/Users/ethanbass/Library/CloudStorage/Box-Box/kessler-data_box/solidago/2019_root_survey/data' #set path
folders <- list.files(path, pattern = 'EXPORT3D')
folders
dat <- load_chroms(folders)
dat <- load_chroms(folders, find_files=TRUE)
folders <- list.files(path, pattern = 'EXPORT3D',full.names = T)
dat <- load_chroms(folders, find_files=TRUE)
dat
names(dat)
names(dat) <- gsub("RS-", "", names(dat))
new.ts <- seq(1,39.9,.01)
new.lambdas <- seq(200,400,2)
### pre-processing (smoothing & baseline correction)
which(sapply(dat[grep(pattern = "MEOH", x = names(dat),invert = T)],dim)[1,]<5993)
names(dat[grep(pattern = "MEOH", x = names(dat),invert = T)])
rm <- c(13,16)
dat.pr <- preprocess(X=dat[-rm][grep(pattern = "MEOH", x = names(dat[-rm]),invert = T)],
dim1=new.ts,
dim2=new.lambdas,
p=.001,lambda=1e5,
mc.cores=3)
###########################################################################################
warp <- correct_rt(dat.pr, lambdas = "210", alg = "vpdtw", what="corrected.values")
warp
warp[[1]]
####
pks.rts <- get_peaks(dat.pr, lamdbas="210")
####
pks.rts <- get_peaks(dat.pr, lambdas="210")
pktab <- get_peaktable(pks.rts)
pktab
##################
wts <- read.csv('/Volumes/USB5/root-survey.csv',stringsAsFactors = F)
##################
wts <- read.csv('root-survey-2019.csv',stringsAsFactors = F)
##################
wts <- read.csv('/Users/ethanbass/Library/CloudStorage/Box-Box/kessler-data/solidago/2019_root survey/root-survey-2019.csv',stringsAsFactors = F)
wts
attach_metadata(pktab, wts, column = "vial")
duplicated(wts$vial)
which(duplicated(wts$vial))
attach_metadata(pktab, wts, column = "vial")
##################
wts <- read.csv('/Users/ethanbass/Library/CloudStorage/Box-Box/kessler-data/solidago/2019_root survey/root-survey-2019.csv',stringsAsFactors = F)
which(duplicated(wts$vial))
attach_metadata(pktab, wts, column = "vial")
pktab <- attach_metadata(pktab, wts, column = "vial")
plot_spectrum("V100", pktab)
plot_spectrum(peak_table = pktab, what="click", lambda="210")
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(loc="V138", peak_table = pktab)
plot_spectrum(loc="V138", peak_table = pktab, chr=2)
plot_spectrum(loc="V138", peak_table = pktab, chr=3)
plot_spectrum(loc="V138", peak_table = pktab, chr=10)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=10)
plot_spectrum(loc="V159", peak_table = pktab, chr=10)
####
pks.rts <- get_peaks(warp, lambdas="210")
pktab <- get_peaktable(pks.rts)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=10)
pktab <- attach_metadata(pktab, wts, column = "vial")
plot_spectrum(loc="V167", peak_table = pktab, chr=10)
plot_spectrum(loc="V167", peak_table = pktab, chr=10)
plot_spectrum(loc="V167", peak_table = pktab)
plot_spectrum(loc="V167", peak_table = pktab,chr=9)
plot_spectrum(loc="V167", peak_table = pktab,chr=8)
plot_spectrum(loc="V167", peak_table = pktab,chr=6)
pktab$sample_meta
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=2)
View(pktab$sample_meta)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=3)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=4)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=5)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=6)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=6)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=6)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=7)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=7)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=7)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=8)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=8)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=8)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=8)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=9)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=9)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=10)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=10)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=11)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=11)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=11)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=12)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=12)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=12)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=14)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=16)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=19)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=19)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=20)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=22)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=28)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=29)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=30)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=28)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=28)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=28)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=29)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=30)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=31)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=34)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=35)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=3)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=37)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=39)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=42)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=44)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=2)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=2)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=2,chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=1,chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13,chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13,chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="330", chr=13,chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=13, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=13, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=13, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=10, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=10, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=10, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chr=2, chrom_list=dat.pr)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=1)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=14)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=14)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=14)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=14)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=15)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=16)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=16)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=16)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=16)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=17)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=18)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=23)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=24)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=25)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=25)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=25)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=25)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=26)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=26)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=26)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=26)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=22)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=21)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=22)
pktab$sample_meta
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=32)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=32)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=33)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=33)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=33)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=34)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=35)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=35)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=37)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=39)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=38)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=42)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=43)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=44)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=44)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=44)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=44)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=45)
plot_spectrum(peak_table = pktab, what="click", lambda="210", chrom_list=dat.pr, chr=45)
# install and load necessary packages
pqts <- c("ade4","RColorBrewer", "gplots", "phyloseq", "randomForest", "tidyr", "vegan", "ggplot2", "dplyr", "lme4", "lmerTest","emmeans", "taxa", "metacoder")
out <- lapply(pqts, function(y) {
if(!y %in% installed.packages()[,"Package"])  install.packages(y)
require(y, character.only = T)
})
# set contrasts for ANOVAs
options(contrasts=c("contr.sum", "contr.poly"))
setwd("/Users/ethanbass/Box/kessler-data/solidago/herbivore_exclusion/2018_inoculation_exp_Mia")
